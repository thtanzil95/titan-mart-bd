<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Titan Mart BD | Checkout</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css"/>
<style>
body{font-family:Arial,sans-serif;background:#f7f7f7;margin:0;padding:20px;}
header{background:#ff4c00;color:#fff;padding:15px;text-align:center;font-size:24px;}
form{max-width:750px;margin:auto;background:#fff;padding:20px;border-radius:10px;}
input,select{width:100%;padding:10px;margin-top:10px;border-radius:5px;border:1px solid #ccc;}
button{background:#ff4c00;color:#fff;padding:12px;border:none;border-radius:5px;width:100%;cursor:pointer;margin-top:15px;}
img.product-img{width:150px;margin-top:10px;}
</style>
</head>
<body>

<header>Titan Mart BD Checkout</header>

<form id="checkoutForm">
  <input type="text" id="name" placeholder="Your Name" required>
  <input type="text" id="phone" placeholder="Phone Number" required>

  <select id="district" required>
    <option value="">Select District</option>
  </select>

  <select id="thana" required>
    <option value="">Select Thana/Upazila</option>
  </select>

  <input type="text" id="address" placeholder="Address" required>
  
  <select id="product" required>
    <option value="850" data-img="arc-lighter.jpg">Arc Lighter - 850 Taka</option>
    <option value="840" data-img="nose-trimmer.jpg">Nose Hair Trimmer - 840 Taka</option>
  </select>

  <select id="qty">
    <option value="1">1</option><option value="2">2</option><option value="3">3</option>
    <option value="4">4</option><option value="5">5</option>
  </select>

  <img id="productImg" class="product-img" src="arc-lighter.jpg">
  /
  <img id="productImg" class="product-img" src="nose-hair-trimmer.jpg">

  <div>Order ID: <span id="orderID">---</span></div>
  <div>Delivery: <span id="deliveryCharge">0</span> Taka</div>
  <div>Total: <span id="total">0</span> Taka</div>

  <button type="button" onclick="placeOrder()">Place Order via WhatsApp</button>
</form>

<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
<script>
// Initialize Choices.js for searchable dropdown
const districtChoice = new Choices('#district',{searchEnabled:true,removeItemButton:false});
const thanaChoice = new Choices('#thana',{searchEnabled:true,removeItemButton:false});
const qtyChoice = new Choices('#qty',{searchEnabled:true,removeItemButton:false});

// Load Bangladesh upazilas
let upazilaData = {};
fetch("bangladesh_upazilas.json")
  .then(resp => resp.json())
  .then(data=>{
    upazilaData = data;
    // Populate district dropdown
    Object.keys(upazilaData).forEach(d=>{
      districtChoice.setChoices([{value:d,label:d}], 'value', 'label', false);
    });
  });

// Generate Order ID
function generateOrderID(){ return 'TMBD-'+Date.now(); }

// Load upazilas based on selected district
document.getElementById('district').addEventListener('change',()=>{
  const dist = document.getElementById('district').value;
  thanaChoice.clearStore();
  thanaChoice.setChoices([{value:'',label:'Select Thana'}], 'value','label',false);
  if(upazilaData[dist]){
    let options = upazilaData[dist].map(u=>({value:u,label:u}));
    thanaChoice.setChoices(options,'value','label',false);
  }
  updateDelivery();
});

// Update product image and total
function updateImage(){
  let img = document.getElementById("product").selectedOptions[0].dataset.img;
  document.getElementById("productImg").src = img;
  updateTotal();
}
document.getElementById('product').addEventListener('change',updateImage);
document.getElementById('qty').addEventListener('change',updateTotal);

// Delivery + total
function updateDelivery(){
  let dist=document.getElementById("district").value;
  document.getElementById("deliveryCharge").innerText = (dist==="Dhaka")?60:120;
  updateTotal();
}
function updateTotal(){
  let price = parseInt(document.getElementById("product").value);
  let qty = parseInt(document.getElementById("qty").value);
  let del = parseInt(document.getElementById("deliveryCharge").innerText);
  document.getElementById("total").innerText = (price*qty)+del;
}

// Place order WhatsApp
function placeOrder(){
  let orderID = generateOrderID();
  document.getElementById("orderID").innerText = orderID;

  let name=document.getElementById("name").value;
  let phone=document.getElementById("phone").value;
  let district=document.getElementById("district").value;
  let thana=document.getElementById("thana").value;
  let address=document.getElementById("address").value;
  let productText=document.getElementById("product").selectedOptions[0].text;
  let qty=document.getElementById("qty").value;
  let total=document.getElementById("total").innerText;

  let msg = `Order ID: ${orderID}\nName: ${name}\nPhone: ${phone}\nDistrict: ${district}\nThana: ${thana}\nAddress: ${address}\nProduct: ${productText}\nQuantity: ${qty}\nTotal: ${total}`;
  window.open("https://wa.me/8801980236917?text="+encodeURIComponent(msg),"_blank");
}

// Initialize totals
updateTotal();
</script>

</body>
</html>



