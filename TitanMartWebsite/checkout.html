<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkout | Titan Mart</title>
</head>
<body>

<h2>Checkout Page</h2>

<form id="checkoutForm">
  Name: <input id="name" type="text"><br><br>
  Phone: <input id="phone" type="text"><br><br>
  Alt Phone: <input id="altphone" type="text"><br><br>
  District: <input id="district" type="text"><br><br>
  Address: <input id="address" type="text"><br><br>

  Product:
  <select id="product" onchange="updateTotal()">
    <option value="850">Arc Lighter</option>
    <option value="840">Nose Hair Trimmer</option>
  </select><br><br>

  Quantity: <input id="qty" type="number" value="1" onchange="updateTotal()"><br><br>

  Delivery:
  <select id="delivery" onchange="updateTotal()">
    <option value="0">Standard</option>
    <option value="50">Express (+50)</option>
  </select><br><br>

  Total: <span id="total">850</span> Taka<br><br>

  <button type="button" onclick="sendOrder()">Place Order</button>
</form>

<script>
// Update total price on quantity or product change
function updateTotal(){
  let productPrice = parseInt(document.getElementById("product").value);
  let qty = parseInt(document.getElementById("qty").value);
  let delivery = parseInt(document.getElementById("delivery").value);
  let total = (productPrice * qty) + delivery;
  document.getElementById("total").innerText = total;
}

// Send order to WhatsApp + Google Sheet + redirect
function sendOrder(){
  let name = document.getElementById("name").value;
  let phone = document.getElementById("phone").value;
  let altphone = document.getElementById("altphone").value;
  let district = document.getElementById("district").value;
  let address = document.getElementById("address").value;
  let productText = document.getElementById("product").options[document.getElementById("product").selectedIndex].text;
  let qty = document.getElementById("qty").value;
  let deliveryText = document.getElementById("delivery").options[document.getElementById("delivery").selectedIndex].text;
  let total = document.getElementById("total").innerText;

  // WhatsApp order
  let msg = encodeURIComponent(
    `üõí New Order\n\nüë§ Name: ${name}\nüìû Phone: ${phone}\nüìû Alt: ${altphone}\nüìç District: ${district}\nüè† Address: ${address}\nüì¶ Product: ${productText}\nüî¢ Qty: ${qty}\nüöö Delivery: ${deliveryText}\nüí∞ Total: ${total}`
  );
  window.open("https://wa.me/8801980236917?text="+msg);

  // Send to Google Sheet
  fetch("https://script.google.com/macros/s/AKfycby5V0I5F9YnVvhoreIlw298ISDYD-YxihexMmDVRuRKARkjdDI5_FAIstKovxLvUvCQZA/exec", {  // <-- Web App URL ‡¶¨‡¶∏‡¶æ‡¶§‡ßá ‡¶π‡¶¨‡ßá
    method:"POST",
    body: JSON.stringify({
      name, phone, altphone, district, address, product: productText,
      qty, delivery: deliveryText, total
    })
  });

  // Redirect to Success page
  setTimeout(()=>{ window.location.href="success.html"; }, 1000);
}
</script>

</body>
</html>