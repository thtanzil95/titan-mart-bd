<!DOCTYPE html>
<html>
<head>
<title>Admin | Titan Mart BD</title>
<style>
body{font-family:Arial}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ccc;padding:8px}
button{padding:8px 12px;background:#28a745;color:#fff;border:none}
</style>
</head>
<body>

<script>
if(localStorage.getItem("admin")!=="yes") location.href="login.html";
</script>

<h2>Orders</h2>
<button onclick="download()">Download Excel</button>

<table>
<thead>
<tr>
<th>ID</th><th>Date</th><th>Name</th><th>Phone</th><th>Product</th><th>Total</th>
</tr>
</thead>
<tbody id="data"></tbody>
</table>

<script>
const orders = JSON.parse(localStorage.getItem("orders")||"[]");
data.innerHTML = orders.map(o=>`
<tr>
<td>${o.id}</td>
<td>${o.date}</td>
<td>${o.name}</td>
<td>${o.phone}</td>
<td>${o.product}</td>
<td>${o.total}</td>
</tr>
`).join("");

function download(){
 let csv="ID,Date,Name,Phone,Product,Total\n";
 orders.forEach(o=>{
  csv+=`${o.id},${o.date},${o.name},${o.phone},${o.product},${o.total}\n`;
 });
 const a=document.createElement("a");
 a.href=URL.createObjectURL(new Blob([csv]));
 a.download="orders.csv";
 a.click();
}
</script>

</body>
</html>
